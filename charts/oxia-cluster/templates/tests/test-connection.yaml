apiVersion: v1
kind: Pod
metadata:
  name: {{ .Release.Name }}-test-connection
  labels:
    {{- include "oxia-cluster.server.labels" . | nindent 4 }}
  annotations:
    "helm.sh/hook": test
spec:
  restartPolicy: Never
  containers:
    - name: oxia-health
      image: "{{ .Values.image.repository }}:{{ .Values.image.tag | default .Chart.AppVersion }}"
      command: ["oxia", "health", "--port={{ include "oxia-cluster.port" .Values.server.config.server.internal.bindAddress }}", "--addr={{ .Release.Name }}-svc"]
